# 思路整理

项目研究经典文献《Macroeconomic Risks in Equity Factor Investing》的核心方法，并将其应用于中国A股市场。整个流程遵循原论文逻辑，并针对中国市场特点进行本土化调整。

## 第一阶段：数据准备与本土化变量选取

### 1. 因子数据
* **目标:** 获取A股市场主流因子的月度回报率序列。
* **因子选择:** 与原论文保持一致，获取以下六个因子的多空组合回报率：
    1. **规模 (Size):** 市值因子 (SMB)
    2. **价值 (Value):** 账面市值比因子 (HML)
    3. **动量 (Momentum):** 过去12个月表现因子 (UMD)
    4. **低风险 (Low Risk):** 低波动率或低Beta因子
    5. **盈利 (High Profitability):** 高盈利能力因子 (RMW)
    6. **投资 (Low Investment):** 低投资水平因子 (CMA)
* **数据来源:**
    * 第三方数据服务商: 如Wind、CSMAR等金融数据库通常提供现成的A股因子收益率数据。坏消息是，**西安电子科技大学图书馆并未提供Wind数据库终端**。
    * 自行构建: 如果希望对因子构建有更强的控制，可以自行下载个股数据构建。这会更耗时，但能保证逻辑的透明。
* **时间跨度:** 选取从2005年至今，以覆盖多个完整的经济周期。频率为**月度**。

### 2. 宏观经济数据
* **核心原则:** 遵循原论文筛选宏观变量的三大标准：
  
    1.  **能反映预期的变化 (Reactive to Expectations):** 选用高频、不易被大幅修正的金融市场变量。
    2.  **与实体经济相关 (Economically Relevant):** 变量需要与中国整体经济活动和投资者总财富相关。
    3.  **有文献支持 (Backed by Literature):** 最好有研究或市场共识支持该变量与A股资产价格的关联。
    
* **本土化变量适配 (替代原论文的7个变量):**
  
    | 原论文的变量                          | 本土化替代                                                   |
    | ------------------------------------- | ------------------------------------------------------------ |
    | 1. 短期利率 (Short Interest Rate)     | 7天期银行间同业拆借利率 (SHIBOR 7D) 或存款类机构7天期质押式回购利率 (DR007)。DR007更能反映银行体系的流动性成本。 |
    | 2. 期限利差 (Term Spread)             | 10年期国债收益率 - 1年期国债收益率。这是衡量收益率曲线陡峭程度的经典指标。 |
    | 3. 信用利差 (Default Spread)          | AAA级企业债收益率 - 国债收益率，或更激进地，AA+级企业债收益率 - 国债收益率。这反映了企业部门的信用风险补偿。 |
    | 4. 股息率 (Aggregate Dividend Yield)  | 中证800或沪深300指数的滚动市盈率倒数或股息率。这反映了股市的整体估值和风险补偿水平。 |
    | 5. 市场波动率 (Systematic Volatility) | 上证50 ETF期权隐含波动率指数（中国波指, iVIX），如果数据长度不足，可使用沪深300指数的已实现月度波动率（基于日收益数据计算）。 |
    | 6. 市场流动性 (Aggregate Illiquidity) | 原文对流动性指标进行了波动率调整 ，我们也应参考相应方法，剔除波动率对流动性指标的干扰。<br />可以使用A股市场流动性较好的股票池（如沪深300成分股）的平均买卖价差的估计值。<br />或者，可以考虑Amihud非流动性指标 (`Amihud = |Return|/ Volume`)，计算所有A股的Amihud指标的月度均值。 |
    
    原文对流动性指标进行了波动率调整，我们也应参考相应方法，剔除波动率的干扰。

### 3. 数据预处理
* **对齐:** 将所有因子收益率和宏观变量的时间序列按月份对齐。
* **缺失值处理:** 检查并处理缺失值。

---

## 第二阶段：核心模型复现与分析

### 1. 提取宏观“意外”
* **方法:** 与原文完全一致，使用向量自回归模型 (VAR) 来捕捉宏观变量的非预期变化。
* **步骤:**
    
    1.  将我们选定的7个中国宏观变量构成一个向量$Z_t$。
    2. 建立一个一阶VAR模型：
       $$
       Z_t = \alpha + \beta Z_{t-1} + \epsilon_t
       $$
    3.  模型残差项 `$\epsilon_t$` 就是我们在`$t$`时刻观测到的“宏观意外”向量。
    4.  **关键步骤-正交化:** 将每个宏观意外 `$\epsilon_t$` 对同期的市场超额收益（如沪深300指数月度收益率 - 无风险利率）做回归，取其残差。这样得到的才是独立于市场贝塔的、纯粹的宏观风险冲击。

### 2. 分析单一宏观风险对因子的影响
* **目标:** 复现原文 `Exhibit 3` 的逻辑，检验A股因子对单个宏观意外的敏感度。
* **方法:** 计算“宏观利差 (Macro Spreads)”。
* **步骤:**
    1.  对于每一个宏观意外序列，将其按大小分为四分位数 (quartiles)。
    2.  计算每个因子在宏观意外最高分位（Q4）和最低分位（Q1）时期的平均收益率。
    3.  两者的差值即为“宏观利差”，并使用t检验判断其显著性。

### 3. 构建本土化的宏观情景
* **目标:** 复现原文 `Exhibit 5` 和 `Exhibit 6` 的逻辑，将多个宏观信号聚合成更稳健的“好时期”和“坏时期”。
* **步骤:** 构建四个综合宏观指标。
    1.  **风险容忍度 (Risk Tolerance):** 将未来市场超额收益对当前的宏观意外做回归，用回归系数作为权重加权求和。
    2.  **宏观展望 (Macro Outlook):** 将未来实体经济指标（如工业增加值）对当前的宏观意外做回归，用回归系数作为权重加权求和。
    3.  **宏观稳定性 (Macro Stability):** 对宏观意外建立多变量GARCH模型，提取条件波动率，再通过主成分分析（PCA）得到共同的“不确定性”指标，取其相反数。
    4.  **风险偏好 (Risk-On Conditions):** 一个简单的规则。当股息率意外和波动率意外同时为负时为“Risk-On”，同时为正时为“Risk-Off”。

---

## 第三阶段：结果验证与组合启示

### 1. 检验因子在综合情景下的表现
* 分析A股因子在上述四种宏观情景的“好时期”和“坏时期”的表现差异（复现`Exhibit 6`）。
* **核心看点:** A股因子是否也普遍表现出“风险性”，即在宏观坏时期表现更差？

### 2. 检验因子组合的风险分散效果
* **目标:** 复现原文`Exhibit 7`的逻辑。
* **方法:** 选取相关性较低但宏观敞口相似/相反的因子构建组合。
* **核心看点:** 比较组合的波动率下降幅度和“宏观偏离”的下降幅度。验证 **低相关性不等于有效的宏观风险分散** 这一结论。

### 3. 探索宏观风险管理对组合的影响
* **目标:** 复现原文`Exhibit 4`和`Exhibit 8`的启发。
* **初步探索:**
    * 识别A股中的“类债券因子”和“利率中性因子”，分析其对持债投资者的影响。
    * 尝试使用优化方法，构建一个对某个宏观情景敞口最低的因子组合（MRD Portfolio），并比较其风险收益特征。
